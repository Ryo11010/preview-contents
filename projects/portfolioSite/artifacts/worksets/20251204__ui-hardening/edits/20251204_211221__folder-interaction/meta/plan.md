# Plan — Edit 20251204_211221__folder-interaction

## 背景 / 目的
- `FolderInteraction.tsx` に散在するマジックナンバーや重複 JSX を整理し、安定性とメンテナンス性を高めます。
- 現状の UI / 機能 / Canvas プレビューを一切変えず、単一ファイル運用を維持します。

## 参照 (Fail-Avoid / Success-Reuse)
- Failure 事例: なし（/artifacts に未登録）。
- Success 事例: なし（/artifacts に未登録）。

## agents.md 重要ポイント（抜粋）
- ハードコード絶対禁止：環境や運用で変わり得る値は定数セクションへ集約し、コード内へ直接埋め込まない。
- A/B/C 方式で代替案を提示し、採用案を明示する。
- 3+1 (before/after/diff/meta) と file-map 更新を各 Edit で必須とする。
- 命名規則（英語・意味明確、真偽値は is*/has* など）と 500 行ルールを遵守する。
- Console ではなく必要に応じてオーバーレイでデバッグ（今回は変更なし）。

## 代替案 (A/B/C)
- (A) 型付きの定数・設定ブロックを設け、Transform/サイズ/カラー/テクスチャ/モーション設定を集約。CardContent を構造化し、重複 JSX を最小化して単一ファイルのまま負債を削減する。Pros: UI 変化なしで可読性・再利用性向上。Cons: 軽微なリファクタ工数。影響: 低。コスト: 中。
- (B) コメント追加や軽微なリント修正のみ。Pros: 工数最小。Cons: 負債が残り品質向上にならない。影響: 低。コスト: 低。
- (C) コンポーネント分割やデザイン改修を大規模に実施。Pros: 抜本的整理。Cons: 単一ファイル維持・UI不変の制約に抵触。影響: 高。コスト: 高。

### 採用案
- **(A) を採用**。UI を変えずに設定集約と型付けで負債を削減し、単一ファイル制約にも沿うため。

## 影響範囲
- UI/挙動: 既存の見た目・アニメーション・クリック/ホバー動作・Canvas プレビューを維持。
- 構造: 設定/定数/型定義の追加とコンポーネント内部ロジックの整理のみ。
- パフォーマンス: 再生成を減らし、小さな描画安定性を狙うが挙動は不変。

## テスト計画
- 手動: ホバー/クリックでの開閉、カード位置・回転・重なり、フタの開閉アニメーション、キャプション表示を確認。
- 自動: 追加テスト基盤は見当たらないため未実施。lint/型チェックは可能なら実行。

## ハードコードに関する計画
- Transform/カラー/サイズ/テクスチャ/モーション等の値を `const` セクションにまとめ、意味のある名前にします。
- 外部テクスチャ URL など環境依存し得る値は定数化し、後から差し替えられる形にします。
- 新規の URL/ID/トークン/閾値/文言を直接埋め込まない。既存の文言は定数に寄せて集中管理します。

## ロールバック方針
- 変更前の `FolderInteraction.tsx` を `before/` に保存し、問題時は復元します。
- 定数化・型付けを段階的に戻すだけで従来挙動に戻せるよう JSX 構造は維持します。

## 相談・承認
- status: **yes**
- approver: user
- time: 2025-12-04 21:12 JST
- memo: 「yes」との承認を受領したため実装を開始する。
