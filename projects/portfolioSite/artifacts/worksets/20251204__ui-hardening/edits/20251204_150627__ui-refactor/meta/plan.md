# Plan — Edit 20251204_150627__ui-refactor

## 背景 / 目的
- 単一ファイルの React ポートフォリオ UI に技術負債が蓄積しているため、安定性とメンテナンス性を高める。
- 既存の UI / 機能 / Canvas プレビューを維持したまま、型安全性と構造化を行う。

## 参照 (Fail-Avoid / Success-Reuse)
- Failure 事例: なし（/artifacts に未登録）。
- Success 事例: なし（/artifacts に未登録）。

## agents.md 重要ポイント（抜粋）
- ハードコード絶対禁止：環境・ビジネス依存値は定数/設定に集約し、本番コードへ直接埋め込まない。
- A/B/C 方式で代替案提示し、採用案を明示する。
- 3+1 (before/after/diff/meta) を各 Edit で整備し、file-map.md 省略禁止。
- 500 行ルール：分割困難な場合は理由と分割計画を明記（今回は単一ファイル制約によりリスクあり）。
- 命名規則遵守：英語・意味明確、マジックナンバーやあいまいな名前禁止。

## 代替案 (A/B/C)
- (A) 型定義と定数集約を行い、UI データ・共通クラス・ハンドラを整理して単一ファイルのまま保守性を向上させる。Pros: 構造化・リスク低、UI 変化なし。Cons: ファイル行数は大きめのまま。影響: 低〜中。コスト: 中。
- (B) 最小限のリント修正のみにとどめる。Pros: 作業量極小。Cons: 負債解消にならない。影響: 低。コスト: 低。
- (C) ファイル分割やコンポーネント再設計を大規模に実施。Pros: 大幅整理。Cons: 単一ファイル要件と現行 UI 保持要件に反する。影響: 高。コスト: 高。

### 採用案
- **(A) を採用**。理由: 単一ファイル・UI不変の制約を守りつつ、データ/型/共通処理の整理で安全に負債を削減できるため。

## 影響範囲
- UI: 既存レイアウト・アニメーション・プレビューを維持（見た目・挙動は変えない）。
- ロジック: スクロール・モーダル・ドックの挙動はそのまま。内部構造のみ整理。
- パフォーマンス: 無駄な再生成を減らし、不要なリソース依存を削る方向で軽微な改善を狙う。

## テスト計画
- 手動: セクションスクロール（ドック/CTA）・プロジェクトシート開閉・アーカイブ表示・メールリンクの動作を確認。
- 自動: 既存のテスト基盤が見当たらないため追加せず。lint/型チェックは実行可能なら実施。

## ハードコードに関する計画
- 変動し得る値（連絡先、SNS URL、外部アセット URL 等）はコンテンツ定数として一箇所に集約し、UI ロジックから分離。
- 外部リソース依存（例: ノイズ画像 URL）は可能な限りローカル/インラインデータへ置換し、環境依存を減らす。
- 新規で環境依存の URL/ID/トークン/閾値は追加しない。

## ロールバック方針
- `app.tsx` の before スナップショットを `before/` に保存し、問題発生時は復元する。
- 追加した定数や型定義を段階的に無効化するだけで元の挙動に戻せるよう、既存の JSX 構造は極力保持する。

## 相談・承認
- status: **yes**
- approver: user
- time: 2025-12-04 15:20 JST
- memo: 「お願いします」との確認を受領し実装を開始。
